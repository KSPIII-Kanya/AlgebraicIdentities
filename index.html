<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kanya Sampoorna Project - Math Simulation</title>
  <style>
    /* (retain your existing CSS) */
    /* ... your full CSS here ... */
    :root{ /* keep the same variables */ }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;width:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; background:#F4F9FF;color:#333;overflow:hidden}
    .app-container{display:flex;flex-direction:column;height:100%;width:100%}
    .header{height:120px;background:#005A9C;color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem}
    .main-content{flex-grow:1;overflow-y:auto;padding:1.5rem}
    .footer{height:50px;background:#005A9C;color:#fff;display:flex;justify-content:center;align-items:center}
    #identity-menu{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem;max-width:1200px;margin:0 auto}
    .identity-card{background:#fff;border:1px solid #DDD;border-radius:12px;padding:1.5rem;text-align:center;cursor:pointer;transition:transform .2s,box-shadow .2s;box-shadow:0 4px 12px rgba(0,0,0,.05);display:flex;flex-direction:column;justify-content:space-between;min-height:280px}
    .identity-card:hover{transform:translateY(-5px);box-shadow:0 8px 20px rgba(0,90,156,.15)}
    .identity-preview{width:100%;height:120px;margin-bottom:1rem;border:1px solid #DDD;border-radius:8px;background:#fdfdfd;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .identity-preview-canvas{width:100%;height:100%;object-fit:contain}
    .identity-preview-img{max-width:100%;max-height:100%;object-fit:contain}
    .identity-name{font-size:1.25rem;font-weight:600;color:#005A9C;margin-bottom:.5rem}
    .identity-formula{font-size:1.1rem;font-weight:500;color:#333;font-family:monospace;margin-bottom:1rem}
    .status-badge{font-size:.9rem;font-weight:600;padding:.5em 1em;border-radius:20px;align-self:center;margin-top:auto}
    .status-badge.complete{background:#E8F5E9;color:#2E7D32}
    .status-badge.coming-soon{background:#FFF3E0;color:#E65100;opacity:.9}
  </style>
</head>
<body>
  <div class="app-container">
    <header class="header">
      <h1>Kanya Sampoorna Project 3.0 / Kanya Girls Education Project</h1>
      <p><strong>The project is supported by TITAN and implemented by KALIKE</strong></p>
      <p>AI-powered Math Simulation for fun, visual, and interactive learning of Algebraic Identities</p>
    </header>

    <main class="main-content" id="main-content-area">
      <div id="identity-menu"></div>
    </main>

    <footer class="footer">
      <p><strong>Powered by AI and created by Kalike: An initiative of Tata Trusts.</strong></p>
    </footer>
  </div>

  <script>
    // ========================================================================
    // GLOBAL STATE & DATA
    // ========================================================================

    // List of all identities - modified: mark a_minus_b_cu as 'complete'
    const IDENTITIES = [
      { id: 'a_plus_b_sq', name: 'Square of a Sum', formula: '(a + b)² = a² + 2ab + b²', status: 'complete', type: 'puzzle' },
      { id: 'a_minus_b_sq', name: 'Square of a Difference', formula: '(a - b)² = a² - 2ab + b²', status: 'complete', type: 'interactive-step' },
      { id: 'a_sq_minus_b_sq', name: 'Difference of Squares', formula: 'a² - b² = (a + b)(a - b)', status: 'complete', type: 'interactive-step' },
      { id: 'a_plus_b_plus_c_sq', name: 'Square of a Trinomial', formula: '(a + b + c)² = a² + b² + c² + 2ab + 2bc + 2ca', status: 'complete', type: 'puzzle' },
      { id: 'a_plus_b_cu', name: 'Cube of a Sum', formula: '(a + b)³ = a³ + 3a²b + 3ab² + b³', status: 'complete', type: 'stepped' },
      
      // *** MODIFIED: Cube of a Difference - now complete and should link to a7.html ***
      { id: 'a_minus_b_cu', name: 'Cube of a Difference', formula: '(a - b)³ = a³ - 3a²b + 3ab² - b³', status: 'complete', type: 'stepped' },

      // 7th formula - will use the screenshot image as the visual icon
      { id: 'a_cu_plus_b_cu', name: 'Sum of Cubes', formula: 'a³ + b³ = (a + b)(a² - ab + b²)', status: 'coming-soon', type: 'stepped' },

      { id: 'a_cu_minus_b_cu', name: 'Difference of Cubes', formula: 'a³ - b³ = (a - b)(a² + ab + b²)', status: 'coming-soon', type: 'stepped' },
      { id: 'x_plus_y_sq_plus_x_minus_y_sq', name: 'Sum of Squares (Expanded)', formula: '(x + y)² + (x - y)² = 2(x² + y²)', status: 'coming-soon', type: 'stepped' },
      { id: 'x_plus_y_sq_minus_x_minus_y_sq', name: 'Difference of Squares (Expanded)', formula: '(x + y)² - (x - y)² = 4xy', status: 'coming-soon', type: 'stepped' },
      { id: 'a_plus_b_plus_c_cu', name: 'Cube of a Trinomial', formula: '(a + b + c)³ = a³ + b³ + c³ + 3(a + b)(b + c)(c + a)', status: 'coming-soon', type: 'stepped' },
      { id: 'pythagoras', name: 'Pythagorean Theorem', formula: 'a² + b² = c²', status: 'coming-soon', type: 'stepped' }
    ];

    // DOM Element references
    let menuView;

    window.onload = () => {
      menuView = document.getElementById('identity-menu');
      createIdentityMenu();
    };

    function createIdentityMenu() {
      menuView.innerHTML = ''; // Clear existing menu

      // Map identity IDs to file names for completed sims
      const filenameMap = {
        'a_plus_b_sq': 'a1.html',
        'a_minus_b_sq': 'a2.html',
        'a_sq_minus_b_sq': 'a3.html',
        'a_plus_b_plus_c_sq': 'a4.html',
        'a_plus_b_cu': 'a6.html',
        // *** NEW: map the cube-of-difference to a7.html ***
        'a_minus_b_cu': 'a7.html'
      };

      IDENTITIES.forEach(identity => {
        const isComplete = identity.status === 'complete';
        const wrapperTag = isComplete ? 'a' : 'div';
        const wrapper = document.createElement(wrapperTag);
        wrapper.className = 'identity-card-link-wrapper';

        if (isComplete) {
          const filename = filenameMap[identity.id];
          if (filename) {
            wrapper.href = `./${filename}`;
          } else {
            wrapper.href = `./sim_${identity.id}.html`;
          }
          wrapper.style.textDecoration = 'none';
          wrapper.style.color = 'inherit';
        }

        const card = document.createElement('div');
        card.className = 'identity-card';
        card.dataset.id = identity.id;

        // Preview container
        const preview = document.createElement('div');
        preview.className = 'identity-preview';

        // Special case: for the 7th identity use the uploaded screenshot as an <img>
        if (identity.id === 'a_cu_plus_b_cu') {
          // Use your screenshot as visual icon. Ensure formulae.png is available next to index.html
          const img = document.createElement('img');
          img.className = 'identity-preview-img';
          img.alt = identity.name + ' preview';
          img.src = './formulae.png'; // <-- place formulae.png next to this file (or change path)
          preview.appendChild(img);
        } else {
          // Default: canvas preview (used for most identities)
          const previewCanvas = document.createElement('canvas');
          previewCanvas.className = 'identity-preview-canvas';
          previewCanvas.width = 240;
          previewCanvas.height = 120;
          preview.appendChild(previewCanvas);
        }

        // Build inner HTML (but leave the preview node we created above)
        const nameDiv = document.createElement('div');
        nameDiv.className = 'identity-name';
        nameDiv.textContent = identity.name;

        const formulaDiv = document.createElement('div');
        formulaDiv.className = 'identity-formula';
        formulaDiv.textContent = identity.formula;

        const badge = document.createElement('span');
        badge.className = `status-badge ${identity.status}`;
        badge.textContent = identity.status === 'complete' ? 'Start Learning' : 'Coming Soon';

        // If not complete, make it look disabled
        if (!isComplete) {
          card.style.cursor = 'not-allowed';
          card.style.opacity = '0.6';
        }

        // Append preview and other pieces explicitly
        card.appendChild(preview);
        card.appendChild(nameDiv);
        card.appendChild(formulaDiv);
        card.appendChild(badge);

        wrapper.appendChild(card);
        menuView.appendChild(wrapper);

        // Draw canvas previews for items that have one (skip the ones using <img>)
        if (identity.id !== 'a_cu_plus_b_cu') {
          requestAnimationFrame(() => {
            const canvasOnCard = card.querySelector('.identity-preview-canvas');
            if (canvasOnCard) {
              drawIdentityPreview(canvasOnCard, identity);
            }
          });
        }
      });
    }

    /**
     * Draws a small, static preview for an identity on its menu card.
     * (I left your original drawIdentityPreview content — trimmed here for brevity.
     *  Make sure to copy the rest of your drawing logic/variants as needed.)
     */
    function drawIdentityPreview(previewCanvas, identity) {
      const pCtx = previewCanvas.getContext('2d');
      const w = previewCanvas.width;
      const h = previewCanvas.height;
      pCtx.clearRect(0, 0, w, h);
      pCtx.font = 'bold 16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
      pCtx.textAlign = 'center';
      pCtx.textBaseline = 'middle';

      const a = 60, b = 40, c = 25;
      const a_minus_b = a - b;
      const x_base = (w - a) / 2;
      const y_base = (h - a) / 2;

      switch (identity.id) {
        case 'a_plus_b_sq':
          pCtx.fillStyle = '#2E86C1';
          pCtx.fillRect(x_base, y_base, a, a);
          pCtx.fillStyle = '#E74C3C';
          pCtx.fillRect(x_base + a, y_base + a, b, b);
          pCtx.fillStyle = '#F39C12';
          pCtx.fillRect(x_base + a, y_base, b, a);
          pCtx.fillRect(x_base, y_base + a, a, b);
          break;

        case 'a_plus_b_cu':
          // simplified preview for cube of sum
          pCtx.fillStyle = '#2E86C1';
          pCtx.fillRect(100, 30, 40, 40); // a^3
          pCtx.fillStyle = '#F39C12';
          pCtx.fillRect(70, 80, 25, 25); // b^3
          pCtx.fillStyle = '#1ABC9C';
          pCtx.fillRect(50, 20, 40, 30); // a^2 b
          // more pieces as you had...
          break;

        case 'a_minus_b_sq':
          pCtx.fillStyle = '#2E86C1';
          pCtx.fillRect(x_base, y_base, a_minus_b, a_minus_b);
          pCtx.fillStyle = '#E74C3C';
          pCtx.fillRect(x_base + a_minus_b, y_base + a_minus_b, b, b);
          pCtx.fillStyle = 'black';
          pCtx.font = 'bold 10px -apple-system';
          pCtx.fillText("(a-b)²", x_base + a_minus_b / 2, y_base + a_minus_b / 2);
          pCtx.fillText("b²", x_base + a_minus_b + b / 2, y_base + a_minus_b + b / 2);
          break;

        case 'a_sq_minus_b_sq':
          // modified preview similar to your earlier version
          const sim_a = 70;
          const sim_b = 35;
          const sim_a_plus_b = sim_a + sim_b;
          const sim_a_minus_b = sim_a - sim_b;
          const rect_w = sim_a_plus_b;
          const rect_h = sim_a_minus_b;
          const rect_x = (w - rect_w) / 2;
          const rect_y = (h - rect_h) / 2 + 10;
          pCtx.fillStyle = '#2E86C1';
          pCtx.fillRect(rect_x, rect_y, sim_a, sim_a_minus_b);
          pCtx.fillStyle = '#1ABC9C';
          pCtx.fillRect(rect_x + sim_a, rect_y, sim_b, sim_a_minus_b);
          pCtx.fillStyle = 'black';
          pCtx.font = 'bold 12px -apple-system';
          pCtx.fillText("a", rect_x + sim_a / 2, rect_y - 25);
          pCtx.fillText("b", rect_x + sim_a + sim_b / 2, rect_y - 25);
          break;

        default:
          pCtx.fillStyle = '#333';
          pCtx.font = 'bold 14px monospace';
          const parts = identity.formula.split('=');
          pCtx.fillText(parts[0], w/2, h/2 - 10);
          pCtx.fillText('=', w/2, h/2 + 6);
          pCtx.fillText(parts[1], w/2, h/2 + 24);
      }
    }

  </script>
</body>
</html>
